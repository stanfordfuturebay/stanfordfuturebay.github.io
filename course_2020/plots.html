<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.8 Plots | Shaping the Future of the Bay Area: Intro to Urban Data Analytics in R</title>
  <meta name="description" content="1.8 Plots | Shaping the Future of the Bay Area: Intro to Urban Data Analytics in R" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="1.8 Plots | Shaping the Future of the Bay Area: Intro to Urban Data Analytics in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.8 Plots | Shaping the Future of the Bay Area: Intro to Urban Data Analytics in R" />
  
  
  

<meta name="author" content="Stanford Future Bay Initiative" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="manipulating-data.html"/>
<link rel="next" href="geospatial-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://bay.stanford.edu">Stanford Future Bay Initiative</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="software-setup.html"><a href="software-setup.html"><i class="fa fa-check"></i><b>1.1</b> Software Setup</a></li>
<li class="chapter" data-level="1.2" data-path="rstudio-interface.html"><a href="rstudio-interface.html"><i class="fa fa-check"></i><b>1.2</b> RStudio Interface</a></li>
<li class="chapter" data-level="1.3" data-path="r-markdown-files.html"><a href="r-markdown-files.html"><i class="fa fa-check"></i><b>1.3</b> R Markdown Files</a></li>
<li class="chapter" data-level="1.4" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>1.4</b> GitHub</a></li>
<li class="chapter" data-level="1.5" data-path="reading-and-saving-files.html"><a href="reading-and-saving-files.html"><i class="fa fa-check"></i><b>1.5</b> Reading and saving files</a></li>
<li class="chapter" data-level="1.6" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>1.6</b> Loops</a></li>
<li class="chapter" data-level="1.7" data-path="manipulating-data.html"><a href="manipulating-data.html"><i class="fa fa-check"></i><b>1.7</b> Manipulating data</a></li>
<li class="chapter" data-level="1.8" data-path="plots.html"><a href="plots.html"><i class="fa fa-check"></i><b>1.8</b> Plots</a></li>
<li class="chapter" data-level="1.9" data-path="geospatial-data.html"><a href="geospatial-data.html"><i class="fa fa-check"></i><b>1.9</b> Geospatial data</a></li>
<li class="chapter" data-level="1.10" data-path="assignment-1.html"><a href="assignment-1.html"><i class="fa fa-check"></i><b>1.10</b> Assignment 1</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="populations.html"><a href="populations.html"><i class="fa fa-check"></i><b>2</b> Populations</a><ul>
<li class="chapter" data-level="2.1" data-path="census-data.html"><a href="census-data.html"><i class="fa fa-check"></i><b>2.1</b> Census data</a></li>
<li class="chapter" data-level="2.2" data-path="equity-analysis.html"><a href="equity-analysis.html"><i class="fa fa-check"></i><b>2.2</b> Equity analysis</a></li>
<li class="chapter" data-level="2.3" data-path="migration.html"><a href="migration.html"><i class="fa fa-check"></i><b>2.3</b> Migration</a></li>
<li class="chapter" data-level="2.4" data-path="microdata.html"><a href="microdata.html"><i class="fa fa-check"></i><b>2.4</b> Microdata</a></li>
<li class="chapter" data-level="2.5" data-path="spatial-subsets.html"><a href="spatial-subsets.html"><i class="fa fa-check"></i><b>2.5</b> Spatial subsets</a></li>
<li class="chapter" data-level="2.6" data-path="assignment-2.html"><a href="assignment-2.html"><i class="fa fa-check"></i><b>2.6</b> Assignment 2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="statistics-part-1.html"><a href="statistics-part-1.html"><i class="fa fa-check"></i><b>3</b> Statistics, Part 1</a><ul>
<li class="chapter" data-level="3.1" data-path="probability-distributions.html"><a href="probability-distributions.html"><i class="fa fa-check"></i><b>3.1</b> Probability distributions</a></li>
<li class="chapter" data-level="3.2" data-path="monte-carlo-simulations.html"><a href="monte-carlo-simulations.html"><i class="fa fa-check"></i><b>3.2</b> Monte Carlo simulations</a></li>
<li class="chapter" data-level="3.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>3.3</b> Simple linear regression</a></li>
<li class="chapter" data-level="3.4" data-path="sampling-bias.html"><a href="sampling-bias.html"><i class="fa fa-check"></i><b>3.4</b> Sampling bias</a></li>
<li class="chapter" data-level="3.5" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>3.5</b> Multiple regression</a></li>
<li class="chapter" data-level="3.6" data-path="assignment-3.html"><a href="assignment-3.html"><i class="fa fa-check"></i><b>3.6</b> Assignment 3</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics-part-2.html"><a href="statistics-part-2.html"><i class="fa fa-check"></i><b>4</b> Statistics, Part 2</a><ul>
<li class="chapter" data-level="4.1" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>4.1</b> Logistic regression</a></li>
<li class="chapter" data-level="4.2" data-path="training-and-testing-data.html"><a href="training-and-testing-data.html"><i class="fa fa-check"></i><b>4.2</b> Training and testing data</a></li>
<li class="chapter" data-level="4.3" data-path="matching.html"><a href="matching.html"><i class="fa fa-check"></i><b>4.3</b> Matching</a></li>
<li class="chapter" data-level="4.4" data-path="difference-in-differences.html"><a href="difference-in-differences.html"><i class="fa fa-check"></i><b>4.4</b> Difference-in-differences</a></li>
<li class="chapter" data-level="4.5" data-path="assignment-4.html"><a href="assignment-4.html"><i class="fa fa-check"></i><b>4.5</b> Assignment 4</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mobility.html"><a href="mobility.html"><i class="fa fa-check"></i><b>5</b> Mobility</a><ul>
<li class="chapter" data-level="5.1" data-path="travel-survey-data.html"><a href="travel-survey-data.html"><i class="fa fa-check"></i><b>5.1</b> Travel survey data</a></li>
<li class="chapter" data-level="5.2" data-path="commute-data.html"><a href="commute-data.html"><i class="fa fa-check"></i><b>5.2</b> Commute data</a></li>
<li class="chapter" data-level="5.3" data-path="routing.html"><a href="routing.html"><i class="fa fa-check"></i><b>5.3</b> Routing</a></li>
<li class="chapter" data-level="5.4" data-path="accessibility.html"><a href="accessibility.html"><i class="fa fa-check"></i><b>5.4</b> Accessibility</a></li>
<li class="chapter" data-level="5.5" data-path="assignment-5.html"><a href="assignment-5.html"><i class="fa fa-check"></i><b>5.5</b> Assignment 5</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="land-use.html"><a href="land-use.html"><i class="fa fa-check"></i><b>6</b> Land Use</a><ul>
<li class="chapter" data-level="6.1" data-path="housing-data.html"><a href="housing-data.html"><i class="fa fa-check"></i><b>6.1</b> Housing data</a></li>
<li class="chapter" data-level="6.2" data-path="parcel-data.html"><a href="parcel-data.html"><i class="fa fa-check"></i><b>6.2</b> Parcel data</a></li>
<li class="chapter" data-level="6.3" data-path="census-to-parcel-disaggregation.html"><a href="census-to-parcel-disaggregation.html"><i class="fa fa-check"></i><b>6.3</b> Census-to-parcel disaggregation</a></li>
<li class="chapter" data-level="6.4" data-path="parcel-and-building-geometries.html"><a href="parcel-and-building-geometries.html"><i class="fa fa-check"></i><b>6.4</b> Parcel and building geometries</a></li>
<li class="chapter" data-level="6.5" data-path="address-geocoding-and-matching.html"><a href="address-geocoding-and-matching.html"><i class="fa fa-check"></i><b>6.5</b> Address geocoding and matching</a></li>
<li class="chapter" data-level="6.6" data-path="assignment-6.html"><a href="assignment-6.html"><i class="fa fa-check"></i><b>6.6</b> Assignment 6</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sustainability.html"><a href="sustainability.html"><i class="fa fa-check"></i><b>7</b> Sustainability</a><ul>
<li class="chapter" data-level="7.1" data-path="vehicle-emissions.html"><a href="vehicle-emissions.html"><i class="fa fa-check"></i><b>7.1</b> Vehicle emissions</a></li>
<li class="chapter" data-level="7.2" data-path="building-emissions.html"><a href="building-emissions.html"><i class="fa fa-check"></i><b>7.2</b> Building emissions</a></li>
<li class="chapter" data-level="7.3" data-path="air-pollution-data.html"><a href="air-pollution-data.html"><i class="fa fa-check"></i><b>7.3</b> Air pollution data</a></li>
<li class="chapter" data-level="7.4" data-path="household-consumption.html"><a href="household-consumption.html"><i class="fa fa-check"></i><b>7.4</b> Household consumption</a></li>
<li class="chapter" data-level="7.5" data-path="assignment-7.html"><a href="assignment-7.html"><i class="fa fa-check"></i><b>7.5</b> Assignment 7</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="hazards.html"><a href="hazards.html"><i class="fa fa-check"></i><b>8</b> Hazards</a><ul>
<li class="chapter" data-level="8.1" data-path="hazard-data.html"><a href="hazard-data.html"><i class="fa fa-check"></i><b>8.1</b> Hazard data</a></li>
<li class="chapter" data-level="8.2" data-path="exposure-data.html"><a href="exposure-data.html"><i class="fa fa-check"></i><b>8.2</b> Exposure data</a></li>
<li class="chapter" data-level="8.3" data-path="vulnerability-data.html"><a href="vulnerability-data.html"><i class="fa fa-check"></i><b>8.3</b> Vulnerability data</a></li>
<li class="chapter" data-level="8.4" data-path="risk-estimation.html"><a href="risk-estimation.html"><i class="fa fa-check"></i><b>8.4</b> Risk estimation</a></li>
<li class="chapter" data-level="8.5" data-path="assignment-8.html"><a href="assignment-8.html"><i class="fa fa-check"></i><b>8.5</b> Assignment 8</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="web-applications.html"><a href="web-applications.html"><i class="fa fa-check"></i><b>9</b> Web Applications</a><ul>
<li class="chapter" data-level="9.1" data-path="dashboards.html"><a href="dashboards.html"><i class="fa fa-check"></i><b>9.1</b> Dashboards</a></li>
<li class="chapter" data-level="9.2" data-path="assignment-9.html"><a href="assignment-9.html"><i class="fa fa-check"></i><b>9.2</b> Assignment 9</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Shaping the Future of the Bay Area: Intro to Urban Data Analytics in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plots" class="section level2">
<h2><span class="header-section-number">1.8</span> Plots</h2>
<p><code>ggplot2</code> from <code>tidyverse</code> provides standard plotting capabilities for dataframes, like bar charts, pie charts, line charts, scatter plots, etc. Each new plot you want to create will require some learning curve on exact formatting, and usually requires a trip to <a href="https://ggplot2.tidyverse.org/">online documentation</a>. While this may few at the onset like it’s much more complicated than creating similar plots in Excel or Google Sheets, I encourage you to resist the temptation to transfer CSV data over to those tools and build up familiarity with plotting in R, because the light at the end of the tunnel is automation and scaling up of plot operations (especially once you can just copy/paste a lot of past plotting scripts), as well as customizable and interactive charts that can be published online.</p>
<p>Generally, plotting with <code>ggplot2</code> involves the function <code>ggplot()</code> that receives at the minimum a dataset, followed by a series of “features” which dictate how the data is visualized, strung together by <code>+</code> signs instead of <code>%&gt;%</code>s (but since the first <code>ggplot()</code> receives a dataset, this entire sequence can be appended to a pipeline). Again, I wouldn’t expect most R users to have memorized exactly what the <code>ggplot2</code> features are unless you very regularly create plots, so usually getting the plot parameters set up correctly involves a lot of copy/paste from online examples. Below is my own example making a stacked bar chart of the PG&amp;E data:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="plots.html#cb37-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb37-2"><a href="plots.html#cb37-2"></a><span class="kw">library</span>(plotly)</span>
<span id="cb37-3"><a href="plots.html#cb37-3"></a></span>
<span id="cb37-4"><a href="plots.html#cb37-4"></a>pge_chart &lt;-</span>
<span id="cb37-5"><a href="plots.html#cb37-5"></a><span class="st">  </span>pge_final <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-6"><a href="plots.html#cb37-6"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb37-7"><a href="plots.html#cb37-7"></a><span class="st">  </span><span class="kw">geom_bar</span>(</span>
<span id="cb37-8"><a href="plots.html#cb37-8"></a>    <span class="kw">aes</span>(</span>
<span id="cb37-9"><a href="plots.html#cb37-9"></a>      <span class="dt">x =</span> MONTH <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">factor</span>(),</span>
<span id="cb37-10"><a href="plots.html#cb37-10"></a>      <span class="dt">y =</span> TOTALKWH,</span>
<span id="cb37-11"><a href="plots.html#cb37-11"></a>      <span class="dt">fill =</span> CUSTOMERCLASS</span>
<span id="cb37-12"><a href="plots.html#cb37-12"></a>    ),</span>
<span id="cb37-13"><a href="plots.html#cb37-13"></a>    <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb37-14"><a href="plots.html#cb37-14"></a>    <span class="dt">position =</span> <span class="st">&quot;stack&quot;</span></span>
<span id="cb37-15"><a href="plots.html#cb37-15"></a>  ) <span class="op">+</span></span>
<span id="cb37-16"><a href="plots.html#cb37-16"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb37-17"><a href="plots.html#cb37-17"></a>    <span class="dt">x =</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb37-18"><a href="plots.html#cb37-18"></a>    <span class="dt">y =</span> <span class="st">&quot;kWh&quot;</span>,</span>
<span id="cb37-19"><a href="plots.html#cb37-19"></a>    <span class="dt">title =</span> <span class="st">&quot;PG&amp;E Territory Monthly Electricity Usage, 2019&quot;</span>,</span>
<span id="cb37-20"><a href="plots.html#cb37-20"></a>    <span class="dt">fill =</span> <span class="st">&quot;Electricity Type&quot;</span></span>
<span id="cb37-21"><a href="plots.html#cb37-21"></a>  )</span>
<span id="cb37-22"><a href="plots.html#cb37-22"></a></span>
<span id="cb37-23"><a href="plots.html#cb37-23"></a>pge_chart</span></code></pre></div>
<p><img src="course_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Notes:</p>
<ul>
<li>I’m choosing to store the plot itself in a variable called <code>pge_chart</code>, which means that to display it in the knitted web page, I need to include the last line. If I didn’t want to store the result in a variable and just plot directly, I’d just start the longer operation with <code>pge_final %&gt;%</code>.</li>
<li>The <code>aes()</code> argument is pretty standard across all kinds of plots, and should correspond well to choices you’d typically make in Excel. <code>fill =</code> lets you specify a field with discrete options that you’d like to use to split your data into groups; in a sense, it’s similar to <code>group_by()</code>. Note that there are different arguments that have a similar grouping affect, and may apply only to different chart types and field types, like <code>linetype =</code> or <code>size =</code>, which you’ll learn as needed.</li>
<li>You could have put the <code>aes()</code> argument inside of <code>ggplot()</code> itself, which would imply that those selections are standard for the entire plot. That happens to be the case here, but I would recommend generally putting this inside of specific plot type function, like <code>geom_bar()</code> or <code>geom_point()</code>, because that lets you make explicit decisions of what data is used for each plot type if you were to combine multiple plot types together.</li>
<li><code>factor()</code> converts the integers in the <code>MONTH</code> field into discrete choices so they refer to months like January, February, etc. instead of just numbers. You are welcome to remove the pipe to <code>factor()</code> to see what happens if you don’t do this. Factors are also typically used when you have a vector of strings and you want to specify a unique order that isn’t default alphabetical (I’ll leave you to learn formatting online as the need arises).</li>
<li><code>stat =</code> here especially lets you distinguish between “identity” and “count” which would be the difference between counting kilowatt-hours on the y-axis or counting the number of entries in the dataframe (more similar to a histogram). You’re encouraged to adjust this to see the effect on the plot.</li>
<li><code>position =</code> here especially lets you choose between stacking the two different customer classes or “dodge” which would put them side by side. Again, you’re encouraged to try it out.</li>
<li><code>labs()</code> generally lets you specify labels, and in this case, because you supplied a <code>fill =</code> argument earlier, you can change the name of the legend by using <code>fill =</code>. There are additional functions you can add to the operation to also customize the labels for the items in the legend, but generally I’d recommend just mutating the original data in advance so that the labels are already what you’d like.</li>
</ul>
<p>There are many ways to customize such plots, but I’ll leave you to explore those on your own based on the plots you want to create, and instead I’d rather point you to an even better way to make plots if you want them to be interactive on a web page, which is with the <code>plotly</code> package. There is a whole separate <a href="https://plotly.com/r/">documentation</a> of how to create plots in <code>plotly</code> which I could have also shown you examples of, but since <code>ggplot2</code> is native to the <code>tidyverse</code> it’s still worth being familiar with. Plus, there’s a neat function created by the <code>plotly</code> team called <code>ggplotly()</code> that generally allows you to convert <code>ggplot2</code> plots into <code>plotly</code> plots, as demonstrated below (recall we’ve already called <code>library(plotly)</code> so we can use this function):</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="plots.html#cb38-1"></a>pge_chart <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplotly</span>()</span></code></pre></div>
<div id="htmlwidget-14b9043a186acdf9ecf1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-14b9043a186acdf9ecf1">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[2405339756,2236397294,2050620632,1788322259,1815189861,2418454504,2726820259,2876356186,2285965349,1818498345,2075274460,2545111200],"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[2411412566,2175465676,2262687638,2340405445,2404667002,2532843133,2720967851,2899824037,2645042957,2493295489,2324287717,2330850760],"text":["MONTH %>% factor(): 1<br />TOTALKWH: 2411412566<br />CUSTOMERCLASS: Elec- Commercial","MONTH %>% factor(): 2<br />TOTALKWH: 2175465676<br />CUSTOMERCLASS: Elec- Commercial","MONTH %>% factor(): 3<br />TOTALKWH: 2262687638<br />CUSTOMERCLASS: Elec- Commercial","MONTH %>% factor(): 4<br />TOTALKWH: 2340405445<br />CUSTOMERCLASS: Elec- Commercial","MONTH %>% factor(): 5<br />TOTALKWH: 2404667002<br />CUSTOMERCLASS: Elec- Commercial","MONTH %>% factor(): 6<br />TOTALKWH: 2532843133<br />CUSTOMERCLASS: Elec- Commercial","MONTH %>% factor(): 7<br />TOTALKWH: 2720967851<br />CUSTOMERCLASS: Elec- Commercial","MONTH %>% factor(): 8<br />TOTALKWH: 2899824037<br />CUSTOMERCLASS: Elec- Commercial","MONTH %>% factor(): 9<br />TOTALKWH: 2645042957<br />CUSTOMERCLASS: Elec- Commercial","MONTH %>% factor(): 10<br />TOTALKWH: 2493295489<br />CUSTOMERCLASS: Elec- Commercial","MONTH %>% factor(): 11<br />TOTALKWH: 2324287717<br />CUSTOMERCLASS: Elec- Commercial","MONTH %>% factor(): 12<br />TOTALKWH: 2330850760<br />CUSTOMERCLASS: Elec- Commercial"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Elec- Commercial","legendgroup":"Elec- Commercial","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[2405339756,2236397294,2050620632,1788322259,1815189861,2418454504,2726820259,2876356186,2285965349,1818498345,2075274460,2545111200],"text":["MONTH %>% factor(): 1<br />TOTALKWH: 2405339756<br />CUSTOMERCLASS: Elec- Residential","MONTH %>% factor(): 2<br />TOTALKWH: 2236397294<br />CUSTOMERCLASS: Elec- Residential","MONTH %>% factor(): 3<br />TOTALKWH: 2050620632<br />CUSTOMERCLASS: Elec- Residential","MONTH %>% factor(): 4<br />TOTALKWH: 1788322259<br />CUSTOMERCLASS: Elec- Residential","MONTH %>% factor(): 5<br />TOTALKWH: 1815189861<br />CUSTOMERCLASS: Elec- Residential","MONTH %>% factor(): 6<br />TOTALKWH: 2418454504<br />CUSTOMERCLASS: Elec- Residential","MONTH %>% factor(): 7<br />TOTALKWH: 2726820259<br />CUSTOMERCLASS: Elec- Residential","MONTH %>% factor(): 8<br />TOTALKWH: 2876356186<br />CUSTOMERCLASS: Elec- Residential","MONTH %>% factor(): 9<br />TOTALKWH: 2285965349<br />CUSTOMERCLASS: Elec- Residential","MONTH %>% factor(): 10<br />TOTALKWH: 1818498345<br />CUSTOMERCLASS: Elec- Residential","MONTH %>% factor(): 11<br />TOTALKWH: 2075274460<br />CUSTOMERCLASS: Elec- Residential","MONTH %>% factor(): 12<br />TOTALKWH: 2545111200<br />CUSTOMERCLASS: Elec- Residential"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Elec- Residential","legendgroup":"Elec- Residential","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":54.7945205479452},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"PG&E Territory Monthly Electricity Usage, 2019","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,12.6],"tickmode":"array","ticktext":["1","2","3","4","5","6","7","8","9","10","11","12"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"categoryorder":"array","categoryarray":["1","2","3","4","5","6","7","8","9","10","11","12"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Month","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-288809011.15,6064989234.15],"tickmode":"array","ticktext":["0e+00","2e+09","4e+09","6e+09"],"tickvals":[0,2000000000,4000000000,6000000000],"categoryorder":"array","categoryarray":["0e+00","2e+09","4e+09","6e+09"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"kWh","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.96751968503937},"annotations":[{"text":"Electricity Type","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"371419753902":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"371419753902","visdat":{"371419753902":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Just like that, you can create a version of the plot that gives you interaction when you hover over the plot, and allows you to deselect items in the legend. You’ll notice there’s a large icon bar that shows up at the top, and by default there is a zoom-in option that can be disorienting; if you’re prefer not to have these, you can add the following into the pipeline:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="plots.html#cb39-1"></a>pge_chart <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-2"><a href="plots.html#cb39-2"></a><span class="st">  </span><span class="kw">ggplotly</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-3"><a href="plots.html#cb39-3"></a><span class="st">  </span><span class="kw">layout</span>(</span>
<span id="cb39-4"><a href="plots.html#cb39-4"></a>    <span class="dt">xaxis =</span> <span class="kw">list</span>(<span class="dt">fixedrange =</span> T),</span>
<span id="cb39-5"><a href="plots.html#cb39-5"></a>    <span class="dt">yaxis =</span> <span class="kw">list</span>(<span class="dt">fixedrange =</span> T)</span>
<span id="cb39-6"><a href="plots.html#cb39-6"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-7"><a href="plots.html#cb39-7"></a><span class="st">  </span><span class="kw">config</span>(<span class="dt">displayModeBar =</span> F)</span></code></pre></div>
<p>If you’re planning to create web reports, there’s essentially never a reason you wouldn’t want to give your reader an interactive plot if you can, and if you so far only know how to generate plots using <code>ggplot2</code>, this is a nifty conversion trick. Otherwise, <code>plotly</code> is less user-friendly to directly code in but provides additional customizability, and is something you’d want to pick up as you start creating dashboards. Here, for your curiosity, would be a recreation of the above plot in native <code>plotly</code>:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="plots.html#cb40-1"></a><span class="kw">plot_ly</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-2"><a href="plots.html#cb40-2"></a><span class="st">  </span><span class="kw">add_trace</span>(</span>
<span id="cb40-3"><a href="plots.html#cb40-3"></a>    <span class="dt">data =</span> pge_final <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(CUSTOMERCLASS <span class="op">==</span><span class="st"> &quot;Elec- Commercial&quot;</span>),</span>
<span id="cb40-4"><a href="plots.html#cb40-4"></a>    <span class="dt">x =</span> <span class="op">~</span>MONTH <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">factor</span>(),</span>
<span id="cb40-5"><a href="plots.html#cb40-5"></a>    <span class="dt">y =</span> <span class="op">~</span>TOTALKWH,</span>
<span id="cb40-6"><a href="plots.html#cb40-6"></a>    <span class="dt">type =</span> <span class="st">&quot;bar&quot;</span>,</span>
<span id="cb40-7"><a href="plots.html#cb40-7"></a>    <span class="dt">name =</span> <span class="st">&quot;Residential&quot;</span></span>
<span id="cb40-8"><a href="plots.html#cb40-8"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-9"><a href="plots.html#cb40-9"></a><span class="st">  </span><span class="kw">add_trace</span>(</span>
<span id="cb40-10"><a href="plots.html#cb40-10"></a>    <span class="dt">data =</span> pge_final <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(CUSTOMERCLASS <span class="op">==</span><span class="st"> &quot;Elec- Commercial&quot;</span>),</span>
<span id="cb40-11"><a href="plots.html#cb40-11"></a>    <span class="dt">x =</span> <span class="op">~</span>MONTH <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">factor</span>(),</span>
<span id="cb40-12"><a href="plots.html#cb40-12"></a>    <span class="dt">y =</span> <span class="op">~</span>TOTALKWH,</span>
<span id="cb40-13"><a href="plots.html#cb40-13"></a>    <span class="dt">type =</span> <span class="st">&quot;bar&quot;</span>,</span>
<span id="cb40-14"><a href="plots.html#cb40-14"></a>    <span class="dt">name =</span> <span class="st">&quot;Commercial&quot;</span></span>
<span id="cb40-15"><a href="plots.html#cb40-15"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-16"><a href="plots.html#cb40-16"></a><span class="st">  </span><span class="kw">layout</span>(</span>
<span id="cb40-17"><a href="plots.html#cb40-17"></a>    <span class="dt">xaxis =</span> <span class="kw">list</span>(</span>
<span id="cb40-18"><a href="plots.html#cb40-18"></a>      <span class="dt">title =</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb40-19"><a href="plots.html#cb40-19"></a>      <span class="dt">fixedrange =</span> T</span>
<span id="cb40-20"><a href="plots.html#cb40-20"></a>    ),</span>
<span id="cb40-21"><a href="plots.html#cb40-21"></a>    <span class="dt">yaxis =</span> <span class="kw">list</span>(</span>
<span id="cb40-22"><a href="plots.html#cb40-22"></a>      <span class="dt">title =</span> <span class="st">&quot;kWh&quot;</span>,</span>
<span id="cb40-23"><a href="plots.html#cb40-23"></a>      <span class="dt">fixedrange =</span> T</span>
<span id="cb40-24"><a href="plots.html#cb40-24"></a>    ),</span>
<span id="cb40-25"><a href="plots.html#cb40-25"></a>    <span class="dt">barmode =</span> <span class="st">&quot;stack&quot;</span>,</span>
<span id="cb40-26"><a href="plots.html#cb40-26"></a>    <span class="dt">legend =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="kw">list</span>(<span class="dt">text =</span> <span class="st">&quot;Electricity Type&quot;</span>))</span>
<span id="cb40-27"><a href="plots.html#cb40-27"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-28"><a href="plots.html#cb40-28"></a><span class="st">  </span><span class="kw">config</span>(<span class="dt">displayModeBar =</span> F)</span></code></pre></div>
<div id="htmlwidget-dc167ed2726a7009bc91" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-dc167ed2726a7009bc91">{"x":{"visdat":{"3714417a12a7":["function () ","plotlyVisDat"],"3714a6b54f1":["function () ","data"],"371411e06b4e":["function () ","data"]},"cur_data":"371411e06b4e","attrs":{"3714a6b54f1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"bar","name":"Residential","inherit":true},"371411e06b4e":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"bar","name":"Commercial","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Month","fixedrange":true,"type":"category","categoryorder":"array","categoryarray":["1","2","3","4","5","6","7","8","9","10","11","12"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"kWh","fixedrange":true},"barmode":"stack","legend":{"title":{"text":"Electricity Type"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false,"displayModeBar":false},"data":[{"x":["1","2","3","4","5","6","7","8","9","10","11","12"],"y":[2411412566,2175465676,2262687638,2340405445,2404667002,2532843133,2720967851,2899824037,2645042957,2493295489,2324287717,2330850760],"type":"bar","name":"Residential","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["1","2","3","4","5","6","7","8","9","10","11","12"],"y":[2411412566,2175465676,2262687638,2340405445,2404667002,2532843133,2720967851,2899824037,2645042957,2493295489,2324287717,2330850760],"type":"bar","name":"Commercial","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>We’ll keep needing plots throughout the whole textbook, so expect to pick up more and more plotting techniques as we go, but also be prepared to Google whenever you want to do something you haven’t done before.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="manipulating-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="geospatial-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": false,
"info": false
});
});
</script>

</body>

</html>
